@{
    ViewData["Title"] = "Manage Patient Samples";
    Layout = "_StaffLayout";
}
<a href="@Url.Action("LabTechnicianDashboard", "StaffHome")" class="btn btn-secondary mb-3">⬅ Back to Dashboard</a>
<h2>🧫 Manage Patient Samples</h2>

<!-- Add Sample Button -->
<button class="btn btn-primary" onclick="openModal('addSampleModal')">➕ Collect New Sample</button>

<!-- Table with Scroll -->
<div class="table-responsive mt-3" style="max-height: 400px; overflow-y: auto;">
    <table class="table table-bordered" id="patientSamplesTable">
        <thead class="table-dark">
            <tr>
                <th>#</th>
                <th>Patient Name</th>
                <th>Test Type</th>
                <th>Sample Type</th>
                <th>Collection Date</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td>John Doe</td>
                <td>Blood Test</td>
                <td>Blood Sample</td>
                <td>2025-03-13</td>
                <td><span class="badge bg-warning">Pending</span></td>
                <td>
                    <button class="btn btn-sm btn-warning" onclick="openUpdateModal('John Doe', 'Blood Test', 'Blood Sample', '2025-03-13', 'Pending')">✏ Update</button>
                    <button class="btn btn-sm btn-info" onclick="openViewModal('John Doe', 'Blood Test', 'Blood Sample', '2025-03-13', 'Pending')">ℹ View</button>
                    <button class="btn btn-sm btn-danger" onclick="openDeleteModal('John Doe')">🗑 Delete</button>
                </td>
            </tr>
            <tr>
                <td>2</td>
                <td>Jane Smith</td>
                <td>Urine Test</td>
                <td>Urine Sample</td>
                <td>2025-03-12</td>
                <td><span class="badge bg-success">Processed</span></td>
                <td>
                    <button class="btn btn-sm btn-info" onclick="openViewModal('Jane Smith', 'Urine Test', 'Urine Sample', '2025-03-12', 'Processed')">ℹ View</button>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<!-- Add Sample Modal -->
<div class="modal fade" id="addSampleModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">➕ Collect New Sample</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <label>Patient Name</label>
                <input type="text" class="form-control mb-2" placeholder="Enter patient name">

                <label>Test Type</label>
                <input type="text" class="form-control mb-2" placeholder="Enter test type">

                <label>Sample Type</label>
                <input type="text" class="form-control mb-2" placeholder="Enter sample type">

                <label>Collection Date</label>
                <input type="date" class="form-control mb-2">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">Save Sample</button>
            </div>
        </div>
    </div>
</div>

<!-- Update Sample Modal -->
<div class="modal fade" id="updateModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">✏ Update Sample</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <label>Patient Name</label>
                <input type="text" id="updatePatientName" class="form-control mb-2" readonly>

                <label>Test Type</label>
                <input type="text" id="updateTestType" class="form-control mb-2" readonly>

                <label>Sample Type</label>
                <input type="text" id="updateSampleType" class="form-control mb-2" readonly>

                <label>Collection Date</label>
                <input type="date" id="updateCollectionDate" class="form-control mb-2">

                <label>Status</label>
                <select id="updateStatus" class="form-control">
                    <option>Pending</option>
                    <option>Processed</option>
                </select>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-warning">Save Changes</button>
            </div>
        </div>
    </div>
</div>

<!-- View Sample Modal -->
<div class="modal fade" id="viewModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">ℹ View Sample Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p><strong>Patient Name:</strong> <span id="viewPatientName"></span></p>
                <p><strong>Test Type:</strong> <span id="viewTestType"></span></p>
                <p><strong>Sample Type:</strong> <span id="viewSampleType"></span></p>
                <p><strong>Collection Date:</strong> <span id="viewCollectionDate"></span></p>
                <p><strong>Status:</strong> <span id="viewStatus"></span></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Delete Sample Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">🗑 Delete Sample</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete <strong id="deletePatientName"></strong>’s sample?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
                <button type="button" class="btn btn-danger">Yes, Delete</button>
            </div>
        </div>
    </div>
</div>

<script>
    function openModal(modalId) {
        var modal = new bootstrap.Modal(document.getElementById(modalId));
        modal.show();
    }

    function openUpdateModal(name, test, sample, date, status) {
        document.getElementById('updatePatientName').value = name;
        document.getElementById('updateTestType').value = test;
        document.getElementById('updateSampleType').value = sample;
        document.getElementById('updateCollectionDate').value = date;
        document.getElementById('updateStatus').value = status;
        openModal('updateModal');
    }

    function openViewModal(name, test, sample, date, status) {
        document.getElementById('viewPatientName').innerText = name;
        document.getElementById('viewTestType').innerText = test;
        document.getElementById('viewSampleType').innerText = sample;
        document.getElementById('viewCollectionDate').innerText = date;
        document.getElementById('viewStatus').innerText = status;
        openModal('viewModal');
    }

    function openDeleteModal(name) {
        document.getElementById('deletePatientName').innerText = name;
        openModal('deleteModal');
    }
</script>
