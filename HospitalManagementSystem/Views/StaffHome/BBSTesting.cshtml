@{
    ViewData["Title"] = "Blood Testing & Screening";
    Layout = "~/Views/Shared/_StaffLayout.cshtml";
}
<a asp-controller="StaffHome" asp-action="BloodBankStaffDashboard" class="btn btn-secondary">⬅ Back to Dashboard</a>

<h2 class="text-center my-3">🧪 Blood Testing & Screening</h2>

<div class="container">
    <div class="d-flex justify-content-between flex-wrap mb-3">
        <input type="text" id="searchInput" class="form-control w-auto" placeholder="🔍 Search Blood Type">
    </div>

    <div class="table-responsive">
        <table class="table table-bordered table-striped text-center" id="testingTable">
            <thead class="table-dark">
                <tr>
                    <th>#</th>
                    <th>Blood Type</th>
                    <th>Donor Name</th>
                    <th>Collection Date</th>
                    <th>Test Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>A+</td>
                    <td>John Doe</td>
                    <td>2025-03-10</td>
                    <td><span class="badge bg-warning">Pending</span></td>
                    <td>
                        <button class="btn btn-sm btn-primary" onclick="openModal('testBloodModal')">🧪 Test</button>
                    </td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>O-</td>
                    <td>Jane Smith</td>
                    <td>2025-03-12</td>
                    <td><span class="badge bg-danger">Rejected</span></td>
                    <td>
                        <button class="btn btn-sm btn-secondary" disabled>❌ Rejected</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- Blood Testing Modal -->
<div id="testBloodModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('testBloodModal')">&times;</span>
        <h4 class="modal-title">🧪 Blood Testing</h4>
        <label>Blood Type:</label>
        <select class="form-control">
            <option>A+</option>
            <option>A-</option>
            <option>B+</option>
            <option>B-</option>
            <option>O+</option>
            <option>O-</option>
            <option>AB+</option>
            <option>AB-</option>
        </select>
        <label>Donor Name:</label>
        <input type="text" class="form-control" placeholder="Enter donor name">
        <label>Test Result:</label>
        <select class="form-control">
            <option>Pass</option>
            <option>Fail</option>
        </select>
        <label>Notes (if any infections detected):</label>
        <textarea class="form-control" placeholder="Enter details"></textarea>
        <button class="btn btn-success mt-3">Save Test Result</button>
    </div>
</div>

<!-- Custom CSS for Modals and Table -->
<style>
    /* Modal Styles */
    .modal {
        display: none;
        position: fixed;
        z-index: 10;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.5);
        justify-content: center;
        align-items: center;
    }

    .modal-content {
        background-color: #fff;
        padding: 20px;
        border-radius: 8px;
        width: 90%;
        max-width: 400px;
        text-align: center;
        position: relative;
    }

    .close {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 24px;
        cursor: pointer;
    }

    /* Table Styling */
    .table th, .table td {
        vertical-align: middle;
    }

    /* Responsive Table */
    .table-responsive {
        overflow-x: auto;
    }

    /* Responsive Design */
    @@media (max-width: 768px) {
        .d-flex

    {
        flex-direction: column;
        gap: 10px;
    }

    .form-control {
        width: 100%;
    }

    }
</style>

<!-- JavaScript for Search and Modal -->
<script>
    // Open Modal Function
    function openModal(modalId) {
        document.getElementById(modalId).style.display = "flex";
    }

    // Close Modal Function
    function closeModal(modalId) {
        document.getElementById(modalId).style.display = "none";
    }

    // Search Blood Type Function
    document.getElementById("searchInput").addEventListener("keyup", function () {
        let filter = this.value.toLowerCase();
        let rows = document.querySelectorAll("#testingTable tbody tr");

        rows.forEach(row => {
            let bloodType = row.cells[1].textContent.toLowerCase();
            row.style.display = bloodType.includes(filter) ? "" : "none";
        });
    });
</script>
