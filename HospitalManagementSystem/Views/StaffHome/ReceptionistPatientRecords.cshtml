@{
    Layout = "_stafflayout";
}

<div style="margin-top: 20px; align-content:center">
    <a href="@Url.Action("ReceptionistDashboard", "StaffHome")" class="btn btn-secondary mb-3"
       style="background-color: #6c757d; color: white; padding: 10px 15px;
              border-radius: 5px; text-decoration: none; display: inline-block;">
        🔙 Back to Dashboard
    </a>
</div>

<div class="container mt-4">
    <div class="card p-4">
        <h3 class="text-center mb-4">📋 Patient Records</h3>

        <!-- Search Bar -->
        <input type="text" id="searchInput" class="form-control mb-3" placeholder="🔍 Search by Name or Condition">

        <div class="table-responsive">
            <table class="table table-bordered" id="patientRecordsTable">
                <thead>
                    <tr>
                        <th onclick="sortTable(0)">Patient ID ⬆⬇</th>
                        <th onclick="sortTable(1)">Name ⬆⬇</th>
                        <th onclick="sortTable(2)">Age ⬆⬇</th>
                        <th>Condition</th>
                        <th>Contact</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="patientTable">
                    <tr>
                        <td>1001</td>
                        <td>John Doe</td>
                        <td>45</td>
                        <td>Diabetes</td>
                        <td>123-456-7890</td>
                        <td>
                            <a href="/Receptionist/ViewPatientDetails?patientId=1001" class="btn btn-sm btn-primary">View</a>
                            <a href="/Receptionist/EditPatient?patientId=1001" class="btn btn-sm btn-warning">Edit</a>
                        </td>
                    </tr>
                    <tr>
                        <td>1002</td>
                        <td>Jane Smith</td>
                        <td>30</td>
                        <td>Flu</td>
                        <td>987-654-3210</td>
                        <td>
                            <a href="/Receptionist/ViewPatientDetails?patientId=1002" class="btn btn-sm btn-primary">View</a>
                            <a href="/Receptionist/EditPatient?patientId=1002" class="btn btn-sm btn-warning">Edit</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    // Search functionality
    document.getElementById("searchInput").addEventListener("keyup", function () {
        let filter = this.value.toLowerCase();
        let rows = document.querySelectorAll("#patientTable tr");
        rows.forEach(row => {
            let name = row.cells[1].textContent.toLowerCase();
            let condition = row.cells[3].textContent.toLowerCase();
            row.style.display = name.includes(filter) || condition.includes(filter) ? "" : "none";
        });
    });

    // Sorting function (sorts table by column index)
    function sortTable(colIndex) {
        let table = document.getElementById("patientRecordsTable").getElementsByTagName("tbody")[0];
        let rows = Array.from(table.rows);
        let sortedRows = rows.sort((a, b) => {
            let cellA = a.cells[colIndex].textContent.trim();
            let cellB = b.cells[colIndex].textContent.trim();

            if (!isNaN(cellA) && !isNaN(cellB)) {
                return Number(cellA) - Number(cellB);
            }
            return cellA.localeCompare(cellB);
        });

        table.innerHTML = "";
        sortedRows.forEach(row => table.appendChild(row));
    }
</script>
